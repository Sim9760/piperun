#!/usr/bin/env ruby

require 'piperun'
require 'mercenary'

Mercenary.program(:piperun) do |p|
  p.version Piperun::VERSION
  p.description "Process files with pipelines"
  p.syntax "piperun <subcommand> [options]"

  p.command(:build) do |c|
    c.syntax "build"

    c.action do |args, options|
      (Piperun::Network.load "Pipeline.rb").run
    end
  end

  p.command(:watch) do |c|
    c.syntax "build"

    c.action do |args, options|
      (Piperun::Network.load "Pipeline.rb").watch
      sleep
    end
  end

  p.default_command(:build)
end

